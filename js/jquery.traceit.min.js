(function(a){a.each(["show","hide"],function(b,d){var c=a.fn[d];a.fn[d]=function(){this.trigger(d);c.apply(this,arguments)}})})(jQuery);(function(d,f){var b={};var c={top:[0,0.9,0.1],top_left:[0.85,0.75,0.95],top_right:[0.1,0.05,0.2],bottom:[0.5,0.4,0.6],bottom_left:[0.65,0.5,0.7],bottom_right:[0.35,0.25,0.45]};var e={init:function(j,k){this.options=d.extend(true,{},this.options,j);this.elem=k;this.$elem=d(k);this._build();return this},options:{traceCanvasPadding:10,redrawSpeed:3500,traceDivPref:"_wrap",traceCursor:"pointer",traceOpt:{stroke:"green","stroke-width":2,"stroke-opacity":1,fill:"none","fill-opacity":0,"gap-point":"top_left",zindex:9999},isVisible:true,useRelativePositioning:false,onHide:function(){console.log("From hide Callback")},onEndTrace:function(){console.log("From end Trace Callback")},onClick:function(j){j.clickTrace()}},_build:function(){this.options.idToTrace=this.elem.id;this.options.wrapIdToTrace=this.elem.id+this.options.traceDivPref;if(this.options.isVisible===false){b[this.options.wrapIdToTrace]={trace:null,isVisible:false,origin:this.elem.id}}else{this.options.traceOffcet=this.options.traceCanvasPadding/2;var l=this.options.useRelativePositioning?this.$elem.offsetParent():null;var p=parseInt(this.$elem.outerWidth())+this.options.traceCanvasPadding;var j=parseInt(this.$elem.outerHeight())+this.options.traceCanvasPadding;var q=this.$elem.offset();var m=parseInt(q.left);var t=parseInt(q.top);if(l){var k=Number(this.$elem.css("margin-top").replace("px",""))||0;var n=Number(this.$elem.css("margin-left").replace("px",""))||0;var o=this.$elem.position();o.top+=k+l.scrollTop();o.left+=n;t=o.top;m=o.left}if((m-this.options.traceOffcet)>0){m=m-this.options.traceOffcet}if((t-this.options.traceOffcet)>0){t=t-this.options.traceOffcet}var r=l?l:this.$elem.parent();d("<div id='"+this.options.wrapIdToTrace+"'></div>").appendTo(r);d("#"+this.options.wrapIdToTrace).css({height:j,width:p,position:"absolute","z-index":this.options.traceOpt.zindex,top:t,left:m});this.drawTrace()}var s=this;this.traceitEvents(s)},drawTrace:function(){var l=new Raphael(this.options.wrapIdToTrace);var k=this;var j=g(l,this.options.wrapIdToTrace,this.options.traceOffcet,this.options.redrawSpeed,this.options.traceOpt,function(){if(k.options.onEndTrace!=undefined){k.options.onEndTrace()}b[k.options.wrapIdToTrace].stable=true});i(j,this.options.wrapIdToTrace,this.options.onClick,k);this.options.shape=j;b[this.options.wrapIdToTrace]={trace:this,isVisible:true,origin:this.elem.id}},reTrace:function(k){var l=this;if(typeof k==="object"){this.options.traceOpt=d.extend({},this.options.traceOpt,k)}if(d("#"+this.options.wrapIdToTrace).length!==0){if(this.options.shape!==null&&b[this.options.wrapIdToTrace].stable==true){d("#"+this.options.wrapIdToTrace).show();b[this.options.wrapIdToTrace].stable=false;if(this.options.traceOpt.redrawSpeed!=undefined){this.options.redrawSpeed=this.options.traceOpt.redrawSpeed}if(this.options.traceOpt.traceCanvasPadding!=undefined){this.options.traceCanvasPadding=this.options.traceOpt.traceCanvasPadding}if(this.options.traceOpt.traceCursor!=undefined){this.options.traceCursor=this.options.traceOpt.traceCursor}var j=h({guidePath:this.options.shape},this.options.redrawSpeed,this.options.traceOpt,function(){if(l.options.onEndTrace!=undefined){l.options.onEndTrace()}b[l.options.wrapIdToTrace].stable=true});i(j,this.options.wrapIdToTrace,this.options.onClick,l);this.options.shape=j;b[this.options.wrapIdToTrace].isVisible=true}}else{this.options.isVisible=true;if(this.options.traceOpt.redrawSpeed!=undefined){this.options.redrawSpeed=this.options.traceOpt.redrawSpeed}if(this.options.traceOpt.traceCanvasPadding!=undefined){this.options.traceCanvasPadding=this.options.traceOpt.traceCanvasPadding}if(this.options.traceOpt.traceCursor!=undefined){this.options.traceCursor=this.options.traceOpt.traceCursor}this._build()}},hideTrace:function(){this.options.shape.hide();d("#"+this.options.wrapIdToTrace).hide();b[this.options.wrapIdToTrace].isVisible=false;if(this.options.onHide!=undefined){this.options.onHide(this.options.shape)}},showTrace:function(){this.reTrace()},clickTrace:function(){var j=this;this.options.shape.animate({opacity:0},1000,function(){j.hideTrace()})},traceitEvents:function(j){this.$elem.bind("hide.trace",function(k){if(j.options.shape!==undefined){j.hideTrace()}});this.$elem.bind("adjust.trace",function(k){if(k.adjustments&&typeof k.adjustments==="object"){j.reTrace(k.adjustments)}else{j.reTrace()}});this.$elem.bind("show.trace",function(k){j.showTrace()});this.$elem.bind("click.trace",function(k){if(j.options.shape!==undefined){j.options.shape.click(j.options.shape.node.onclick())}});this.$elem.bind("delete.trace",function(k){if(j.options.shape!==undefined){console.log(j.options,j.options.wrapIdToTrace);j.options.shape.remove();d("#"+j.options.wrapIdToTrace).remove()}delete b[j.options.wrapIdToTrace];j.$elem.removeData("trace")})},click:function(){if(this.options.shape!==undefined){this.options.shape.click(this.options.shape.node.onclick())}}};function i(k,n,m,j){var l=k;l.data("name",n);l.node.onmouseover=function(){this.style.cursor=j.options.traceCursor};l.node.onclick=function(){if(m!=undefined){m(j)}}}function g(C,A,R,N,m,t){var w=d("#"+A);var D=0;var E=0;if(R!==0){D=E=R/2}var z=R;var I=R;var H=parseInt(w.outerWidth());var F=parseInt(w.outerHeight());var u=(H-R*2)/2;var s=(F-R*2)/2;var L=z+u;var n=I+s;var P=u;var M=s+R;var K=u;var J=s-R;var Q=C.ellipse(L,n,K,J).attr({stroke:"none",fill:"none"});var j=C.ellipse(L,n,P,M).attr({stroke:"none",fill:"none"});var l,x,v;var k=m["gap-point"];if(typeof k!="string"&&typeof k!="number"){console.log("Bad location value: "+k+" please specify value between 0% and 100%. Switching to default location 85%.");k="top_left"}if(typeof k==="string"){if(c[k]==undefined){k="top_left"}l=c[k][0];x=c[k][1];v=c[k][2]}else{if(typeof k==="number"){l=k/100;if(l>1){l=0.85;console.log("Bad location value: "+k+" please specify value between 0% and 100%. Switching to default location 85%.")}x=l-0.1;if(x<0){x=1-x}v=l+0.1;if(v>1){v=v-1}}}var O=Q.getTotalLength();var y=j.getTotalLength();var r=Q.getPointAtLength(l*O);var q=Q.getPointAtLength(x*O);var o=j.getPointAtLength(v*y);Q.remove();j.remove();var G="M "+r.x+", "+r.y+" A "+K+" "+J+" 0 1 1 "+q.x+", "+q.y+" A "+P+" "+M+" 0 0 1 "+o.x+", "+o.y;var B=h({canvas:C,pathstr:G},N,m,t);return B}function h(o,n,j,q){var l,p;var k=o.guidePath;if(k===undefined){l=o.canvas;p=o.pathstr;k=l.path(p).attr({stroke:"none",fill:"none"})}else{l=k.paper;k.attr({stroke:"none",fill:"none"})}var m=l.path(k.getSubpath(0,1)).attr(j);return a(k,m,n,j,q)}function a(o,s,m,n,p){var q=o.getTotalLength(o);var k=new Date().getTime();var j=50;var r=s;var l=setInterval(function(){var t=new Date().getTime()-k;var u=t/m*q;var v=o.getSubpath(0,u);n.path=v;s.animate(n,j);if(t>=m){clearInterval(l);if(p!=undefined){p()}o.remove()}},j);return r}d(document).bind("keyup.trace",function(j){if(j.keyCode===27){d.each(b,function(l,k){if(b[l].isVisible===true){k.trace.reTrace()}})}});d(f).resize(function(){d.each(b,function(k,j){d("#"+k).remove()});if(this.resizeTO){clearTimeout(this.resizeTO)}this.resizeTO=setTimeout(function(){d(this).trigger("resizeEnd")},800)});d(f).bind("resizeEnd",function(){d.each(b,function(k,j){if(b[k].isVisible===true){if(d("#"+b[k].origin).is(":visible")){j.trace.reTrace()}else{j.trace.hideTrace()}}})});if(typeof Object.create!=="function"){Object.create=function(k){function j(){}j.prototype=k;return new j()}}d.traceit=function(k,j){d.fn[k]=function(l){return this.each(function(){if(!d.data(this,k)){d.data(this,k,Object.create(j).init(l,this))}})}};d.traceit("trace",e)}($,window));
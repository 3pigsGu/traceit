(function(a){a.each(["show","hide"],function(b,d){var c=a.fn[d];a.fn[d]=function(){this.trigger(d);c.apply(this,arguments)}})})(jQuery);(function(f,e){var h={};var d={init:function(i,j){this.options=f.extend(true,{},this.options,i);this.elem=j;this.$elem=f(j);this._build();return this},options:{traceCanvasPadding:10,redrawSpeed:3500,traceDivPref:"_wrap",traceCursor:"pointer",traceOpt:{stroke:"green","stroke-width":2,"stroke-opacity":1,fill:"none","fill-opacity":0,zindex:9999},isVisible:true,useRelativePositioning:false,onHide:function(){console.log("From hide Callback")},onEndTrace:function(){console.log("From end Trace Callback")},onClick:function(i){i.clickTrace()}},_build:function(){this.options.idToTrace=this.elem.id;this.options.wrapIdToTrace=this.elem.id+this.options.traceDivPref;if(this.options.isVisible===false){h[this.options.wrapIdToTrace]={trace:null,isVisible:false,origin:this.elem.id}}else{this.options.traceOffcet=this.options.traceCanvasPadding/2;var k=this.options.useRelativePositioning?this.$elem.offsetParent():null;var o=parseInt(this.$elem.outerWidth())+this.options.traceCanvasPadding;var i=parseInt(this.$elem.outerHeight())+this.options.traceCanvasPadding;var p=this.$elem.offset();var l=parseInt(p.left);var s=parseInt(p.top);if(k){var j=Number(this.$elem.css("margin-top").replace("px",""))||0;var m=Number(this.$elem.css("margin-left").replace("px",""))||0;var n=this.$elem.position();n.top+=j+k.scrollTop();n.left+=m;s=n.top;l=n.left}if((l-this.options.traceOffcet)>0){l=l-this.options.traceOffcet}if((s-this.options.traceOffcet)>0){s=s-this.options.traceOffcet}var q=k?k:this.$elem.parent();f("<div id='"+this.options.wrapIdToTrace+"'></div>").appendTo(q);f("#"+this.options.wrapIdToTrace).css({height:i,width:o,position:"absolute","z-index":this.options.traceOpt.zindex,top:s,left:l});this.drawTrace()}var r=this;this.traceitEvents(r)},drawTrace:function(){var k=new Raphael(this.options.wrapIdToTrace);var j=this;var i=c(k,this.options.idToTrace,this.options.traceOffcet,this.options.redrawSpeed,this.options.traceOpt,function(){if(j.options.onEndTrace!=undefined){j.options.onEndTrace()}h[j.options.wrapIdToTrace].stable=true});g(i,this.options.wrapIdToTrace,this.options.onClick,j);this.options.shape=i;h[this.options.wrapIdToTrace]={trace:this,isVisible:true,origin:this.elem.id}},reTrace:function(j){var k=this;if(typeof j==="object"){this.options.traceOpt=f.extend({},this.options.traceOpt,j)}if(f("#"+this.options.wrapIdToTrace).length!==0){if(this.options.shape!==null&&h[this.options.wrapIdToTrace].stable==true){f("#"+this.options.wrapIdToTrace).show();h[this.options.wrapIdToTrace].stable=false;var i=b({guidePath:this.options.shape},this.options.redrawSpeed,this.options.traceOpt,function(){if(k.options.onEndTrace!=undefined){k.options.onEndTrace()}h[k.options.wrapIdToTrace].stable=true});g(i,this.options.wrapIdToTrace,this.options.onClick,k);this.options.shape=i;h[this.options.wrapIdToTrace].isVisible=true}}else{this.options.isVisible=true;this._build()}},hideTrace:function(){this.options.shape.hide();f("#"+this.options.wrapIdToTrace).hide();h[this.options.wrapIdToTrace].isVisible=false;if(this.options.onHide!=undefined){this.options.onHide(this.options.shape)}},showTrace:function(){this.reTrace()},clickTrace:function(){var i=this;this.options.shape.animate({opacity:0},1000,function(){i.hideTrace()})},traceitEvents:function(i){this.$elem.bind("hide.trace",function(j){if(i.options.shape!==undefined){i.hideTrace()}});this.$elem.bind("adjust.trace",function(j){if(j.adjustments&&typeof j.adjustments==="object"){i.reTrace(j.adjustments)}else{i.reTrace()}});this.$elem.bind("show.trace",function(j){i.showTrace()});this.$elem.bind("click.trace",function(j){if(i.options.shape!==undefined){i.options.shape.click(i.options.shape.node.onclick())}});this.$elem.bind("delete.trace",function(j){if(i.options.shape!==undefined){this.options.shape.hide().remove();f("#"+this.options.wrapIdToTrace).hide().remove()}h.splice(this.options.wrapIdToTrace,1);this.$elem.removeData("trace")})},click:function(){if(this.options.shape!==undefined){this.options.shape.click(this.options.shape.node.onclick())}}};function g(j,m,l,i){var k=j;k.data("name",m);k.node.onmouseover=function(){this.style.cursor="pointer"};k.node.onclick=function(){if(l!=undefined){l(i)}}}function c(z,E,M,I,k,s){var N=f("#"+E);var A=0;var B=0;if(M!==0){A=B=M/2}var x=M;var G=M;var F=parseInt(N.outerWidth());var C=parseInt(N.outerHeight());var H=x+F/2;var l=G+C/2;var t=(F-A)/2;var r=(C-A)/2;var L=t;var q=r+M*2;var K=z.ellipse(H,l,t,r).attr({stroke:"none",fill:"none"});var i=z.ellipse(H,l,L,q).attr({stroke:"none",fill:"none"});var j=0.85;var v=0.75;var u=0.95;var J=K.getTotalLength();var w=i.getTotalLength();var o=K.getPointAtLength(j*J);var n=K.getPointAtLength(v*J);var m=i.getPointAtLength(u*w);K.remove();i.remove();var D="M "+o.x+", "+o.y+" A "+t+" "+r+" 0 1 1 "+n.x+", "+n.y+" A "+L+" "+q+" 0 0 1 "+m.x+", "+m.y;var y=b({canvas:z,pathstr:D},I,k,s);return y}function b(n,m,i,p){var k,o;var j=n.guidePath;if(j===undefined){k=n.canvas;o=n.pathstr;j=k.path(o).attr({stroke:"none",fill:"none"})}else{k=j.paper;j.attr({stroke:"none",fill:"none"})}var l=k.path(j.getSubpath(0,1)).attr(i);return a(j,l,m,i,p)}function a(n,r,l,m,o){var p=n.getTotalLength(n);var j=new Date().getTime();var i=50;var q=r;var k=setInterval(function(){var s=new Date().getTime()-j;var t=s/l*p;var u=n.getSubpath(0,t);m.path=u;r.animate(m,i);if(s>=l){clearInterval(k);if(o!=undefined){o()}n.remove()}},i);return q}f(document).bind("keyup.trace",function(i){if(i.keyCode===27){f.each(h,function(k,j){if(h[k].isVisible===true){j.trace.reTrace()}})}});f(e).resize(function(){f.each(h,function(j,i){f("#"+j).remove()});if(this.resizeTO){clearTimeout(this.resizeTO)}this.resizeTO=setTimeout(function(){f(this).trigger("resizeEnd")},800)});f(e).bind("resizeEnd",function(){f.each(h,function(j,i){if(h[j].isVisible===true){if(f("#"+h[j].origin).is(":visible")){i.trace.reTrace()}else{i.trace.hideTrace()}}})});if(typeof Object.create!=="function"){Object.create=function(j){function i(){}i.prototype=j;return new i()}}f.traceit=function(j,i){f.fn[j]=function(k){return this.each(function(){if(!f.data(this,j)){f.data(this,j,Object.create(i).init(k,this))}})}};f.traceit("trace",d)}($,window));